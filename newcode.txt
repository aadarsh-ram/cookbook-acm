def suffix_array_best(s):
  n = len(s)
  k = 1
  line = to_int_keys_best(s)
  while max(line) < n - 1:
    line = to_int_keys_best(
      [a * (n + 1) + b + 1
      for (a, b) in
      zip_longest(line, islice(line, k, None),
            fillvalue=-1)])
    k <<= 1
  return line
